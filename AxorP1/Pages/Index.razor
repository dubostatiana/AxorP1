@page "/"

@inherits IndexBase

<PageTitle>Tableau de bord</PageTitle>

@if (DataSource.Count() == 0) 
{
    <div class="loading-circle-container">
        <div class="loading-circle">
        </div>
    </div>
}
else
{
  <div class="dashboard-container">
    <SfDashboardLayout @ref="@DashboardLayout" ID="DashBoardLayout" Columns="@Columns" MediaQuery="@MediaQuery" CellSpacing="@Spacing" CellAspectRatio="@Ratio" AllowResizing="true" ShowGridLines="true" AllowFloating="true" AllowDragging="true" EnablePersistence="true" DraggableHandle=".e-panel-header">
        <DashboardLayoutEvents Created="@Created" OnResizeStop="@OnResizeStop" OnWindowResize="@OnWindowResize" />
        <DashboardLayoutPanels>

            @try
            {
                    @foreach (PanelObject Panel in PanelData)
                    {
                        <DashboardLayoutPanel Id="@Panel.Id" Row="@Panel.Row" Column="@Panel.Column" SizeX="@Panel.SizeX" SizeY="@Panel.SizeY" MinSizeX="@Panel.MinSizeX" MinSizeY="@Panel.MinSizeY">
                            <HeaderTemplate><div>@Panel.Title</div></HeaderTemplate>
                            <ContentTemplate>
                                <div class="panel">
                                <DynamicComponent @ref="@componentReference" Type="@Panel.ComponentType" Parameters="@Panel.Parameters" />
                            </div>
                            </ContentTemplate>
                       </DashboardLayoutPanel>
                    }
            }
            catch(Exception ex)
            {
                    Logger.LogError($"Error in DashboardLayout loop: {ex.Message} {ex.StackTrace}");
            }
            

        </DashboardLayoutPanels>
    </SfDashboardLayout>
  </div>
}

<style>

    /* Dashboard layout */

    .dashboard-container{
        margin: 10px;
        overflow: hidden;
        touch-action: none;
    }

    .dashboard-container::before {
        content:"" ;
        background-color: #f3f2f1;
        position:absolute;
        width:100%;
        height:100%;
        top:0;
        left:0;
    }

    .e-panel-header {
        text-align: center;
        padding:10px !important;
        height:auto !important;

    }

    .e-panel-content {
        text-align: center;
        padding-bottom: 20px;
    }

    .e-dashboardlayout.e-control .e-dashboard-gridline-table {
    }


    .panel {
        width: 100%;
        height: 100%;
        overflow: hidden;
    }


    /* Grid Group T/A Component */
    .groupta {
        display: inline-block;
        border-radius: 50%;
        margin: auto;
        color: white;
        padding: 6px;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    }

    #actif {
        background-color: red;
    }

    #inactif {
        background-color: yellowgreen;
    }

    /* Localisation Map Component */

    /* Markers  */
    .e-maps #Map_LayerIndex_0_MarkerGroup path:hover {
        cursor: pointer;
    }

    

</style>

